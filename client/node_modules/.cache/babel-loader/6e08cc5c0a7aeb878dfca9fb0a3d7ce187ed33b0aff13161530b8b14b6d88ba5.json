{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{useNavigate}from\"react-router-dom\";import IngrService from\"../../services/ingr.service\";import CategoryService from\"../../services/category.service\";import Select from'react-select';import{Modal,Form,Button}from'react-bootstrap';import\"../style.css\";import MyRecipeService from\"../../services/myrecipe.service\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const NewRecipePage=()=>{const navigate=useNavigate();const[name,setName]=useState('');const[desc,setDesc]=useState('');const[newIngrs,setNewIngrs]=useState([]);const[newCats,setNewCats]=useState([]);const[steps,setSteps]=useState('');const[allIngrs,setAllIngrs]=useState([]);const[allCats,setAllCats]=useState([]);const save=async()=>{const date=new Date();const offset=date.getTimezoneOffset();const new_recipe={name:name,desc:desc,steps:steps,post_time:new Date(date.getTime()-offset*60*1000).toISOString().substring(0,10)};const{data}=await MyRecipeService.addRecipe(new_recipe);if(newIngrs.length)await MyRecipeService.addItem(data.insertId,newIngrs);if(newCats.length)await MyRecipeService.addCat(data.insertId,newCats);navigate(\"/myrecipe/\".concat(data.insertId));};useEffect(()=>{IngrService.getAll().then(_ref=>{let{data}=_ref;const temp=data.map(element=>{return{value:element.id,label:element.name};});setAllIngrs(temp);}).catch(err=>{console.log(err);});CategoryService.getAll().then(_ref2=>{let{data}=_ref2;const temp=data.map(element=>{return{value:element.id,label:element.name};});setAllCats(temp);}).catch(err=>{console.log(err);});},[]);return/*#__PURE__*/_jsx(\"main\",{children:/*#__PURE__*/_jsxs(Modal,{show:true,centered:true,scrollable:true,size:\"xl\",backdrop:\"static\",onHide:()=>navigate(\"/myrecipe\"),children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsx(Modal.Title,{children:\" Write Recipe \"})}),/*#__PURE__*/_jsx(Modal.Body,{children:/*#__PURE__*/_jsxs(Form,{children:[/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",controlId:\"name\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\" Name \"}),/*#__PURE__*/_jsx(Form.Control,{type:\"name\",defaultValue:name,onChange:e=>setName(e.target.value)})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",controlId:\"cats\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\" Categories \"}),/*#__PURE__*/_jsx(Select,{name:\"cats\",className:\"basic-multi-select\",classNamePrefix:\"select\",options:allCats,value:newCats,isMulti:true,closeMenuOnSelect:false,onChange:value=>setNewCats(value)})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",controlId:\"desc\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\" Desciption \"}),/*#__PURE__*/_jsx(Form.Control,{as:\"textarea\",rows:3,type:\"desc\",defaultValue:desc,onChange:e=>setDesc(e.target.value)})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",controlId:\"ingrs\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\" Ingredients \"}),/*#__PURE__*/_jsx(Select,{name:\"ingrs\",className:\"basic-multi-select\",classNamePrefix:\"select\",options:allIngrs,value:newIngrs,isMulti:true,closeMenuOnSelect:false,onChange:value=>setNewIngrs(value)})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",controlId:\"steps\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\" Steps \"}),/*#__PURE__*/_jsx(Form.Control,{as:\"textarea\",rows:10,defaultValue:steps,onChange:e=>setSteps(e.target.value)})]})]})}),/*#__PURE__*/_jsxs(Modal.Footer,{children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:()=>navigate(\"/myrecipe\"),children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:save,children:\"Save\"})]})]})});};export default NewRecipePage;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","IngrService","CategoryService","Select","Modal","Form","Button","MyRecipeService","jsx","_jsx","jsxs","_jsxs","NewRecipePage","navigate","name","setName","desc","setDesc","newIngrs","setNewIngrs","newCats","setNewCats","steps","setSteps","allIngrs","setAllIngrs","allCats","setAllCats","save","date","Date","offset","getTimezoneOffset","new_recipe","post_time","getTime","toISOString","substring","data","addRecipe","length","addItem","insertId","addCat","concat","getAll","then","_ref","temp","map","element","value","id","label","catch","err","console","log","_ref2","children","show","centered","scrollable","size","backdrop","onHide","Header","closeButton","Title","Body","Group","className","controlId","Label","Control","type","defaultValue","onChange","e","target","classNamePrefix","options","isMulti","closeMenuOnSelect","as","rows","Footer","variant","onClick"],"sources":["/home/kcheng/Desktop/CSCE608-Project1-BOBA/client/src/components/recipe/newRecipe-component.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport IngrService from \"../../services/ingr.service\";\nimport CategoryService from \"../../services/category.service\";\nimport Select from 'react-select';\nimport {Modal, Form, Button} from 'react-bootstrap';\nimport \"../style.css\";\nimport MyRecipeService from \"../../services/myrecipe.service\";\n\nconst NewRecipePage = () => {\n  const navigate = useNavigate();\n  const [name, setName] = useState('');\n  const [desc, setDesc] = useState('');\n  const [newIngrs, setNewIngrs] = useState([]);\n  const [newCats, setNewCats] = useState([]);\n  const [steps, setSteps] = useState('');\n  const [allIngrs, setAllIngrs] = useState([]);\n  const [allCats, setAllCats] = useState([]);\n\n\n  const save = async () => {\n    const date = new Date();\n    const offset = date.getTimezoneOffset();\n    const new_recipe = {\n      name: name,\n      desc: desc,\n      steps: steps,\n      post_time: new Date(date.getTime() - (offset*60*1000)).toISOString().substring(0,10)\n    }\n    const {data} = await MyRecipeService.addRecipe(new_recipe);\n    if(newIngrs.length)\n      await MyRecipeService.addItem(data.insertId, newIngrs);\n    if(newCats.length)\n      await MyRecipeService.addCat(data.insertId, newCats);\n    navigate(`/myrecipe/${data.insertId}`);\n  }\n  \n  useEffect(() => {\n    IngrService.getAll()\n    .then(({data}) => {\n      const temp = data.map((element) => {return {value: element.id, label: element.name}});\n      setAllIngrs(temp);\n    }).catch((err) => {\n      console.log(err)\n    });\n\n    CategoryService.getAll()\n    .then(({data}) => {\n      const temp = data.map((element) => {return {value: element.id, label: element.name}});\n      setAllCats(temp);\n    }).catch((err) => {\n      console.log(err)\n    });\n  }, []);\n\n  return (\n    <main>\n      <Modal show={true} centered scrollable size='xl' \n        backdrop=\"static\" onHide={() => navigate(\"/myrecipe\")}>\n        <Modal.Header closeButton>\n          <Modal.Title> Write Recipe </Modal.Title>\n        </Modal.Header>\n        <Modal.Body>\n          <Form>\n            <Form.Group className=\"mb-3\" controlId=\"name\">\n              <Form.Label> Name </Form.Label>\n              <Form.Control type=\"name\" defaultValue={name} onChange={(e) => setName(e.target.value)}/>\n            </Form.Group>\n            <Form.Group className=\"mb-3\" controlId=\"cats\">\n              <Form.Label> Categories </Form.Label>\n              <Select\n                name=\"cats\"\n                className=\"basic-multi-select\"\n                classNamePrefix=\"select\"\n                options={allCats}\n                value={newCats}\n                isMulti\n                closeMenuOnSelect={false}\n                onChange={(value) => setNewCats(value)}\n              />\n            </Form.Group>\n            <Form.Group className=\"mb-3\" controlId=\"desc\">\n              <Form.Label> Desciption </Form.Label>\n              <Form.Control as=\"textarea\" rows={3} type=\"desc\" defaultValue={desc} onChange={(e) => setDesc(e.target.value)}/>\n            </Form.Group>\n            <Form.Group className=\"mb-3\" controlId=\"ingrs\">\n              <Form.Label> Ingredients </Form.Label>\n              <Select\n                name=\"ingrs\"\n                className=\"basic-multi-select\"\n                classNamePrefix=\"select\"\n                options={allIngrs}\n                value={newIngrs}\n                isMulti\n                closeMenuOnSelect={false}\n                onChange={(value) => setNewIngrs(value)}\n              />\n            </Form.Group>\n            <Form.Group className=\"mb-3\" controlId=\"steps\">\n              <Form.Label> Steps </Form.Label>\n              <Form.Control as=\"textarea\" rows={10} defaultValue={steps} onChange={(e) => setSteps(e.target.value)}/>\n            </Form.Group>\n          </Form>\n        </Modal.Body>\n        <Modal.Footer>\n          <Button variant=\"secondary\" onClick={() => navigate(\"/myrecipe\")}>\n            Cancel\n          </Button>\n          <Button variant=\"primary\" onClick={save}>\n            Save\n          </Button>\n        </Modal.Footer>\n      </Modal> \n    </main>\n  );\n};\n\nexport default NewRecipePage;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}